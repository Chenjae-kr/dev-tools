<!DOCTYPE html><html lang="ko" data-theme="light"><head><meta charset="UTF-8">
  <link rel="icon" type="image/svg+xml" href="/dev-tools/favicon.svg">
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>SQL Seeder Generator | Dev Tools</title><script src="../../tools.js"></script><script src="../../nav.js"></script><script src="../../ui-utils.js"></script><link rel="stylesheet" href="../../styles.css"><style>.txt{width:100%;min-height:220px;background:transparent;border:none;outline:none;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:12px;line-height:1.7;padding:14px 20px;resize:vertical}</style></head><body><script>renderNav();</script><div class="container"><div class="tool-header"><h1>SQL Test Data <span>Seeder</span></h1><p>// FK 순서를 고려해 다중 테이블 INSERT 생성</p></div><div class="main-grid"><div><div class="panel"><div class="panel-header"><div class="panel-title"><div class="dot"></div>INPUT</div></div><div class="setting-group" data-level="basic"><div class="setting-title">Source</div><textarea id="schema" class="txt" placeholder="users: id:int pk, name:string, email:email\norders: id:int pk, user_id:int fk users.id, amount:int(100,500)">users: id:int pk, name:string, email:email
orders: id:int pk, user_id:int fk users.id, amount:int(100,500)</textarea></div><div class="setting-group" data-level="basic"><div class="setting-title">Options</div><div class="options-bar"><span class="options-label">Rows/table</span><input id="rows" class="table-name-input input-xs" type="number" value="5" min="1" max="200"><span class="options-label">Seed</span><input id="seed" class="table-name-input input-xs" type="number" value="42"></div></div><button class="generate-btn" onclick="gen()" data-shortcut="Ctrl + Enter">⚡ 생성</button></div></div><div class="output-panel" id="out"><div class="panel"><div class="empty-state"><div class="icon">🌱</div><p>스키마 입력 후 GENERATE</p></div></div></div></div><footer>// SQL Test Data Seeder Generator</footer></div><script>
const esc=UIUtils.escHtml;function rng(seed){let t=seed>>>0;return()=>{t+=0x6D2B79F5;let x=Math.imul(t^(t>>>15),1|t);x^=x+Math.imul(x^(x>>>7),61|x);return((x^(x>>>14))>>>0)/4294967296}}
function parse(){const lines=document.getElementById('schema').value.split(/\r?\n/).map(l=>l.trim()).filter(Boolean);const tables=[];for(const line of lines){const [name,rest]=line.split(':');if(!name||!rest) throw new Error('형식: table: col:type ...');const cols=rest.split(',').map(s=>s.trim()).map(c=>{const p=c.split(/\s+/);const [cn,ct]=p[0].split(':');const o={name:cn,type:ct||'string',pk:false,fk:null};if(p.includes('pk'))o.pk=true;const fkIdx=p.indexOf('fk');if(fkIdx>=0&&p[fkIdx+1])o.fk=p[fkIdx+1];return o});tables.push({name:name.trim(),cols})}return tables}
function topo(tables){const deps=new Map(tables.map(t=>[t.name,new Set()]));tables.forEach(t=>t.cols.forEach(c=>{if(c.fk){const ref=c.fk.split('.')[0];if(ref!==t.name)deps.get(t.name).add(ref)}}));const out=[];const seen=new Set();let changed=true;while(changed){changed=false;for(const t of tables){if(seen.has(t.name))continue;const ok=[...deps.get(t.name)].every(d=>seen.has(d));if(ok){seen.add(t.name);out.push(t);changed=true}}}if(out.length!==tables.length) throw new Error('FK 순환 의존성이 있습니다.');return out}
function genVal(col,i,r,ctx){const t=(col.type||'string').toLowerCase();if(col.fk){const [rt,rc]=col.fk.split('.');const arr=ctx[rt]||[];if(!arr.length) return 1;return arr[Math.floor(r()*arr.length)][rc]}
if(t==='int')return i+1;if(t.startsWith('int(')){const m=t.match(/int\((\d+),(\d+)\)/);if(m){const a=+m[1],b=+m[2];return Math.floor(r()*(b-a+1))+a;}}
if(t==='email')return `user${i+1}@example.com`;if(t==='string')return `${col.name}_${i+1}`;return `${col.name}_${i+1}`}
function sql(v){if(typeof v==='number')return String(v);return `'${String(v).replace(/'/g,"''")}'`}
function gen(){try{const per=Math.max(1,Math.min(200,parseInt(document.getElementById('rows').value||'5',10)));const r=rng(parseInt(document.getElementById('seed').value||'42',10));const ordered=topo(parse());const ctx={};let out='';for(const t of ordered){ctx[t.name]=[];for(let i=0;i<per;i++){const row={};t.cols.forEach(c=>row[c.name]=genVal(c,i,r,ctx));ctx[t.name].push(row);const cols=t.cols.map(c=>c.name).join(', ');const vals=t.cols.map(c=>sql(row[c.name])).join(', ');out+=`INSERT INTO ${t.name} (${cols}) VALUES (${vals});\n`;}out+='\n';}
const id='seed_'+Date.now();document.getElementById('out').innerHTML=UIUtils.renderSqlBlock({badge:'SEED',tag:`${ordered.length} tables`,copyBtnId:`copy_${id}`,copyLabel:'COPY',copyHandler:`copyOut('${id}')`,wrapBtnId:id,bodyHtml:`<pre class="sql-code" id="${id}">${esc(out)}</pre>`});scrollToOutput(document.getElementById('out'));
}catch(e){UIUtils.showError('out',e.message)}}
function copyOut(id){UIUtils.copyElementText(id,`copy_${id}`,'COPY')}
document.addEventListener('keydown',e=>{if((e.ctrlKey||e.metaKey)&&e.key==='Enter')gen();});
</script></body></html>